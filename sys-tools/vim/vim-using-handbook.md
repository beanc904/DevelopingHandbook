vim编辑器的使用手册

# 一、vim的基本使用

## 1.三种模式
**命令模式**：只可以对文件进行预览与命令操作；

**编辑模式**：可对文件内容进行编辑；

**可视模式**：可对文件内容进行批量选中；

```vim
" 进入文件默认为命令模式
i   a                       " 进入编辑模式【命令模式】
" 其中i是在光标前插入，a是在光标后插入

esc                         " 退出编辑模式【编辑模式、可视模式】
v                           " 进入可视模式【命令模式】
```

## 2.vim的多种命令行进入方法
**进入**

```vim
vim <file>                  " 打开file

vim +<number> <file>        " 打开file并移动光标至number行

vim +/<keyword> <file>      " 打开file并高亮显示keyword

vim <file> <file> <file>    " 打开数个file，可在文件内切换
```

**退出**

```vim
:q                          " 在命令模式下
```

# 二、命令模式

## 1.光标移动
```vim
^                           " 移动至行首

$                           " 移动至行末

gg                          " 移动至文件首行

G                           " 移动至文件末行

<number> + G                " 移动至文件number行

<number> + 方向键上下左右     " 向上向下向左向右移动number行

Ctrl + b                    " 向上翻屏

Ctrl + f                    " 向下翻屏
```

## 2.复制与粘贴
```vim
yy                          " 复制光标所在行

<number> yy                 " 从光标行开始向下复制指定number行，包括光标行在内

Ctrl + v yy                 " 进入可视化复制，移动方向选中后，yy确认

p                           " 在光标后位置处粘贴寄存器中内容
```

## 3.剪切与删除
```vim
dd                          " 剪切光标所在行，同时也是删除

<number> dd                 " 从光标行开始向下剪切指定number行，包括光标行在内

D                           " 剪切光标所在行，但不会上移以下内容填充空白
```

## 4.撤销与恢复
```vim
:u                          " 撤销上一步操作

Ctrl + r                    " 恢复撤销操作
```

## 5.调用外部命令
```vim
:q <outside order>          " 将会退出文件执行outside order后按任意键回到文件中
```

## 6.存储与退出等操作
```vim
:w                          " 保存当前文件
:w <path>                   " 将当前文件另存至path

:q                          " 退出当前文件
:wq                         " 保存并退出
:q!                         " 不保存并强制退出
```

## 7.查找与替换
```vim
#查找
:/<keyword>                 " 高亮显示文件中的keyword

N / n                       " 上移下移查找的内容

:nohl                       " 取消高亮显示查找的内容

#替换
:s/<context>/<new context>      " 替换光标行第一个context

:s/<context>/<new context>/g    " 替换光标行所有context

:%s/<context>/<new context>     " 替换文件内所有行的第一处context

:%s/<context>/<new context>/g   " 替换文件内所有行的所有context
```

## 8.切换文件
```vim
:files                          " 查看同时打开的所有files

:open <file>                    " 切换至其他打开的文件

:bp                             " 切换至上一个打开的文件

:bn                             " 切换至下一个打开的文件
```

## 9.vim的功能模块
**行号显示**：
```vim
:set nu                         " 临时显示行号

:set nonu                       " 临时取消行号
```

**代码着色**：
```vim
:syntax on                      " 临时开启代码着色

:syntax off                     " 临时关闭代码着色
```

## 10.简易计算器
**简单介绍**：编辑文件需要使用到计算器时，可不退出文件，使用vim提供的简易计算器完成计算。

**使用方法**：在编辑模式下，使用键盘`Ctrl` + `r` + `=`，光标会移动至末行，键盘输入计算格式后回车，计算结果会返回至原光标处。

# 三、vim的额外机制
## 1.vim的配置
**临时配置**：命令模式下使用`:`输入的配置信息，下次打开不会生效。

**个人配置**：个人配置文件存储路径为`~/.vimrc`，此配置只会对本用户永久生效。

**全局配置**：全局配置对系统生效，存储路径为`/etc/vim/vimrc`。

## 2.vim的异常退出机制
杀死vim正在编辑文件的进程后，在拥有工作目录权限时，会在工作目录（或者系统的临时文件目录）下生成一个`.<file name>.swp`的临时交换文件。

Vim 的 `.swp` 交换文件机制是为防止数据丢失和保护用户编辑过程中数据安全的一种机制。当你在 Vim 中编辑一个文件时，Vim 会创建一个交换文件，以便在意外情况下（如系统崩溃或断电）可以恢复未保存的编辑内容。

### `.swp` 交换文件的作用
- **保存编辑中的更改**：在你编辑一个文件时，Vim 会定期将未保存的更改写入交换文件中，而不是直接修改原文件。这样即使 Vim 崩溃或者你的计算机意外关闭，你仍然可以恢复到最近保存的状态。
- **防止多重编辑冲突**：如果你尝试打开一个已经在 Vim 中被打开的文件，Vim 会检测到交换文件的存在，并发出警告，防止多人同时编辑同一文件导致的冲突。

### `.swp` 文件的生成和位置
- 当你编辑文件时，Vim 会在相同目录下创建一个 `.swp` 文件。该文件的命名通常是以 `.` 开头，后跟你正在编辑的文件名，然后再加上 `.swp` 后缀。例如，编辑 `example.txt` 文件时，Vim 会创建一个 `.example.txt.swp` 文件。
- 如果 Vim 无法在相同目录下创建 `.swp` 文件（例如没有写权限），它会尝试在系统的临时目录中创建该文件。

### `.swp` 文件的使用
- **恢复数据**：如果 Vim 检测到一个遗留的 `.swp` 文件，它会提示你文件可能在上次编辑中未正常关闭，并提供几个选项，比如打开该文件、恢复数据、删除 `.swp` 文件等。
- **删除 `.swp` 文件**：如果你确定没有需要恢复的数据，或者文件只是因为某次非正常退出而残留了 `.swp` 文件，你可以选择删除该文件。

### 关闭 `.swp` 文件功能
- 如果你不希望 Vim 生成 `.swp` 文件，可以在 Vim 的配置文件（通常是 `~/.vimrc` 或 `~/.config/nvim/init.vim`）中添加以下行：
  ```vim
  set noswapfile
  ```
  但是，关闭 `.swp` 文件后，你将失去 Vim 的自动恢复功能，因此谨慎使用。

## 3.vim的别名机制
Vim 的别名机制允许你为常用的命令创建简短的替代命令，称为“别名”。在 Vim 中，这种别名机制通过定义 **命令别名**（command alias）和 **键映射**（key mapping）实现。

### 3.1. 命令别名
命令别名可以让你为 Vim 的内置命令或自定义命令创建一个更简短的名称。通过 `:command` 指令，你可以创建一个新的命令别名。

#### 创建命令别名
使用 `:command` 定义一个别名。语法如下：
```vim
:command <alias> <original_command>
```

**示例：**
```vim
:command WQ wq
```
这行命令创建了一个 `WQ` 的别名，它相当于 `wq` 命令，保存并退出 Vim。现在在 Vim 中输入 `:WQ` 就等同于输入 `:wq`。

#### 删除命令别名
使用 `:delcommand` 删除已定义的别名：
```vim
:delcommand WQ
```

### 3.2. 键映射（Key Mapping）
键映射允许你将一个键序列映射到一个命令或一组命令，常用于创建快捷键。

#### 普通模式下的键映射
使用 `:nmap` 或 `:nnoremap`（不递归映射）为普通模式创建键映射：
```vim
nnoremap <key_sequence> <command>
```

**示例：**
```vim
nnoremap <leader>w :w<CR>
```
这行命令将 `<leader>w` 映射为保存文件的命令 `:w`，其中 `<leader>` 是你定义的一个特殊键，默认是 `\`。

#### 插入模式下的键映射
使用 `:imap` 或 `:inoremap`（不递归映射）为插入模式创建键映射：
```vim
inoremap <key_sequence> <command>
```

**示例：**
```vim
inoremap jk <Esc>
```
这行命令让你在插入模式下通过输入 `jk` 退出插入模式，这是一种常见的快捷键配置。

#### 删除键映射
使用 `:unmap` 删除普通模式下的键映射：
```vim
:unmap <key_sequence>
```

**示例：**
```vim
:unmap <leader>w
```

### 3.3. 文件中的别名定义
你可以将命令别名或键映射写入 Vim 的配置文件（如 `~/.vimrc` 或 `~/.config/nvim/init.vim`）中，这样每次启动 Vim 时这些别名和映射都会自动加载。

**示例：**
```vim
" 在 .vimrc 文件中
command WQ wq
nnoremap <leader>w :w<CR>
inoremap jk <Esc>
```

## 4.退出方式
**语法**：
```vim
" 在打开的文件未被修改的情况下，使用:x不会修改文件的修改时间
:x
" 无论如何，文件的修改时间一定会改变
:q  :wq
```
